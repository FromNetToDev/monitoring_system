# roles/consul/templates/consul.hcl.j2
# Consul Configuration - Compatible with all versions
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

datacenter = "{{ datacenter }}"
data_dir   = "{{ consul_data_dir }}"
log_level  = "{{ consul_log_level }}"

bind_addr   = "{{ consul_bind_address }}"
client_addr = "{{ consul_client_address }}"

{% if consul_servers is defined and consul_servers | length > 0 %}
retry_join = [
  {% for server in consul_servers %}
  "{{ server }}"{% if not loop.last %},{% endif %}
  {% endfor %}
]
{% endif %}

{% if consul_node_role == "server" %}
server = true
bootstrap_expect = {{ consul_bootstrap_expect }}
{% else %}
server = false
{% endif %}

enable_script_checks = {{ consul_enable_script_checks | lower }}
enable_local_script_checks = {{ consul_enable_local_script_checks | lower }}
